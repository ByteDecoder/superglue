(function(){(function(){(function(){this.Breezy={}}).call(this)}).call(this);var t=this.Breezy;(function(){(function(){t.DoublyLinkedList=function(){function t(){this.head=this.tail=null,this.length=0}return t.prototype.createNode=function(t){return{prev:null,element:t,next:null}},t.prototype.push=function(t){var e;return this.tail?(e=this.createNode(t),e.prev=this.tail,this.tail=this.tail.next=e,this.length+=1):(this.head=this.tail=this.createNode(t),this.length+=1)},t.prototype.pop=function(){var t;return this.tail?(t=this.tail,this.tail=t.prev,t.prev=null,this.tail&&(this.tail.next=null),this.head===t&&(this.head=null),this.length-=1,t.element):null},t.prototype.shift=function(){var t;return this.head?(t=this.head,this.head=t.next,t.next=null,this.head&&(this.head.prev=null),this.tail===t&&(this.tail=null),this.length-=1,t.element):null},t.prototype.unshift=function(t){var e;return this.head?(e=this.createNode(t),e.next=this.head,this.head=this.head.prev=e,this.length+=1):(this.head=this.tail=this.createNode(t),this.length+=1)},t}()}).call(this),function(){var e;e=function(){return(new Date).getTime().toString(36)},t.ComponentUrl=function(){function r(e){return this.original=null!=e?e:document.location.href,this.original.constructor===t.ComponentUrl?this.original:void this._parse()}return r.prototype.withoutHash=function(){return this.href.replace(this.hash,"").replace("#","")},r.prototype.withoutHashForIE10compatibility=function(){return this.withoutHash()},r.prototype.hasNoHash=function(){return 0===this.hash.length},r.prototype.crossOrigin=function(){return this.origin!==(new t.ComponentUrl).origin},r.prototype.formatForXHR=function(t){return null==t&&(t={}),(t.cache?this.withMimeBust():this.withAntiCacheParam()).withoutHashForIE10compatibility()},r.prototype.withMimeBust=function(){return new t.ComponentUrl(/([?&])__=[^&]*/.test(this.absolute)?this.absolute:new t.ComponentUrl(this.withoutHash()+(/\?/.test(this.absolute)?"&":"?")+"__=0"+this.hash))},r.prototype.withAntiCacheParam=function(){return new t.ComponentUrl(/([?&])_=[^&]*/.test(this.absolute)?this.absolute.replace(/([?&])_=[^&]*/,"$1_="+e()):new t.ComponentUrl(this.withoutHash()+(/\?/.test(this.absolute)?"&":"?")+("_="+e())+this.hash))},r.prototype._parse=function(){var t;return(null!=this.link?this.link:this.link=document.createElement("a")).href=this.original,t=this.link,this.href=t.href,this.protocol=t.protocol,this.host=t.host,this.hostname=t.hostname,this.port=t.port,this.pathname=t.pathname,this.search=t.search,this.hash=t.hash,":"===this.protocol&&(this.protocol=document.location.protocol),""===this.protocol&&(this.protocol=document.location.protocol),""===this.port&&(this.port=document.location.port),""===this.hostname&&(this.hostname=document.location.hostname),""===this.pathname&&(this.pathname="/"),this.origin=[this.protocol,"//",this.hostname].join(""),0!==this.port.length&&(this.origin+=":"+this.port),this.relative=[this.pathname,this.search,this.hash].join(""),this.absolute=this.href},r}()}.call(this),function(){t.CSRFToken=function(){function t(){}return t.get=function(t){var e;return null==t&&(t=document),{node:e=t.querySelector('meta[name="csrf-token"]'),token:null!=e&&"function"==typeof e.getAttribute?e.getAttribute("content"):void 0}},t.update=function(t){var e;if(e=this.get(),null!=e.token&&null!=t&&e.token!==t)return e.node.setAttribute("content",t)},t}()}.call(this),function(){var e,r,n,i,s,o,a,h,u,l,c,p,d,f,y=[].indexOf||function(t){for(var e=0,r=this.length;e<r;e++)if(e in this&&this[e]===t)return e;return-1};p=function(t,e){var r,n;for(r in e)n=e[r],t.hasOwnProperty(r)||(t[r]=n);return t},u=function(t,e){var r,n;for(r in e)n=e[r],t[r]=n;return t},i=function(t){var e,r,n;if(null==t||"object"!=typeof t)return t;e=new t.constructor;for(r in t)n=t[r],e[r]=i(n);return e},f=function(){return function(e,r){var n;return n=new t.ComponentUrl(r.url),p(e,{url:n.relative,pathname:n.pathname,cachedAt:(new Date).getTime(),assets:[],data:{},title:"",positionY:0,positionX:0,csrf_token:null})}}(this),e=function(){var t;return t=navigator.userAgent,(t.indexOf("Android 2.")!==-1||t.indexOf("Android 4.0")!==-1)&&t.indexOf("Mobile Safari")!==-1&&t.indexOf("Chrome")===-1&&t.indexOf("Windows Phone")===-1},n=function(){return window.history&&"pushState"in window.history&&"state"in window.history},l=function(t){var e,r;return r=(null!=(e=document.cookie.match(new RegExp(t+"=(\\w+)")))?e[1].toUpperCase():void 0)||"",document.cookie=t+"=; expires=Thu, 01-Jan-70 00:00:01 GMT; path=/",r},c=function(){var t;return"GET"===(t=l("request_method"))||""===t},r=function(){return n()&&!e()&&c()},o=function(t,e){var r,n,i,s,o;for(t.length>e.length&&(i=[e,t],t=i[0],e=i[1]),s=[],r=0,n=t.length;r<n;r++)o=t[r],y.call(e,o)>=0&&s.push(o);return s},d=function(){return function(t,e,r){var n;return null==r&&(r=document),n=document.createEvent("Events"),e&&(n.data=e),n.initEvent(t,!0,!0),r.dispatchEvent(n)}}(this),s=function(t,e){return document.addEventListener(t,function(t){var r,n;for(n=t.target;n!==document&&null!=n;){if("A"===n.nodeName&&(r=n.getAttribute("disabled"),n.getAttribute("disabled")&&t.preventDefault(),!r))return void e(t);n=n.parentNode}})},h=function(t){return"[object Object]"===Object.prototype.toString.call(t)},a=function(t){return"[object Array]"===Object.prototype.toString.call(t)},t.Grafter=function(){function e(){this.current_path=[]}return e.prototype.graftByKeypath=function(e,r,n,i){var s,o,u,l,c,p,d,f,y,g,m,v,b,C,T,w;if(null==i&&(i={}),"string"==typeof e)return e=e.split("."),this.graftByKeypath(e,r,n,i);if(c=e[0],this.current_path.push(c),null!=n&&(o=n[c]),T=e.slice(1),0===e.length){if("add"===i.type&&a(n)){for(u=[],p=0,m=n.length;p<m;p++)o=n[p],u.push(o);return u.push(r),u}return r}if(h(n)){u={},l=!1;for(g in n)w=n[g],g===c?(b=this.graftByKeypath(T,r,o,i),o!==b&&(l=!0),u[g]=b):u[g]=w;return l?(this.current_path.pop(),u):(t.Utils.warn("Could not find key "+c+" in keypath "+this.current_path.join(".")),n)}if(a(n)){if(C=c.split("="),s=C[0],d=C[1],l=!1,void 0===d)f=parseInt(s),o=n[f],b=this.graftByKeypath(T,r,o,i),o!==b&&(l=!0),u=n.slice(0,f),u.push(b),u=u.concat(n.slice(f+1,n.length));else for(d=parseInt(d)||0,u=[],y=0,v=n.length;y<v;y++)o=n[y],o[s]===d?(b=this.graftByKeypath(T,r,o,i),o!==b&&(l=!0),u.push(b)):u.push(o);return l?(this.current_path.pop(),u):(t.Utils.warn("Could not find key "+c+" in keypath "+this.current_path.join(".")),n)}return n},e}(),this.Breezy.Utils={warn:function(){return console.warn.apply(this,arguments)},graftByKeypath:function(){var e;return e=new t.Grafter,e.graftByKeypath.apply(e,arguments)},documentListenerForLinks:s,reverseMerge:p,merge:u,clone:i,withDefaults:f,browserSupportsBreezy:r,intersection:o,triggerEvent:d}}.call(this),function(){var e=function(t,e){return function(){return t.apply(e,arguments)}};t.Snapshot=function(){function r(t){this.controller=t,this.graftByKeypath=e(this.graftByKeypath,this),this.assetsChanged=e(this.assetsChanged,this),this.changePage=e(this.changePage,this),this.updateCurrentBrowserState=e(this.updateCurrentBrowserState,this),this.reflectNewUrl=e(this.reflectNewUrl,this),this.removeParamFromUrl=e(this.removeParamFromUrl,this),this.rememberCurrentUrlAndState=e(this.rememberCurrentUrlAndState,this),this.cacheCurrentPage=e(this.cacheCurrentPage,this),this.pagesCached=e(this.pagesCached,this),this.transitionCacheFor=e(this.transitionCacheFor,this),this.constrainPageCacheTo=e(this.constrainPageCacheTo,this),this.onHistoryChange=e(this.onHistoryChange,this),this.pageCache={},this.currentBrowserState=null,this.pageCacheSize=10,this.currentPage=null,this.loadedAssets=null}return r.prototype.onHistoryChange=function(e){var r,n,i,s;if((null!=(i=e.state)?i.breezy:void 0)&&e.state.url!==this.currentBrowserState.url)return n=new t.ComponentUrl(this.currentBrowserState.url),r=new t.ComponentUrl(e.state.url),(s=this.pageCache[r.absolute])?(this.cacheCurrentPage(),this.currentPage=s,this.controller.restore(this.currentPage)):this.controller.request(e.target.location.href)},r.prototype.constrainPageCacheTo=function(t){var e,r,n,i,s,o;for(null==t&&(t=this.pageCacheSize),s=Object.keys(this.pageCache),e=s.map(function(t){return function(e){return t.pageCache[e].cachedAt}}(this)).sort(function(t,e){return e-t}),o=[],r=0,i=s.length;r<i;r++)n=s[r],this.pageCache[n].cachedAt<=e[t]&&o.push(delete this.pageCache[n]);return o},r.prototype.transitionCacheFor=function(t){var e;if(t!==this.currentBrowserState.url)return e=this.pageCache[t],e&&!e.transitionCacheDisabled?e:void 0},r.prototype.pagesCached=function(t){if(null==t&&(t=this.pageCacheSize),/^[\d]+$/.test(t))return this.pageCacheSize=parseInt(t)},r.prototype.cacheCurrentPage=function(){var e;if(this.currentPage)return e=new t.ComponentUrl(this.currentBrowserState.url),t.Utils.merge(this.currentPage,{cachedAt:(new Date).getTime(),positionY:window.pageYOffset,positionX:window.pageXOffset,url:e.relative,pathname:e.pathname,transition_cache:!0}),this.pageCache[e.absolute]=this.currentPage},r.prototype.rememberCurrentUrlAndState=function(){return window.history.replaceState({breezy:!0,url:document.location.href},"",document.location.href),this.currentBrowserState=window.history.state},r.prototype.removeParamFromUrl=function(t,e){return t.replace(new RegExp("^([^#]*?)(([^#]*)&)?"+e+"(=[^&#]*)?(&|#|$)"),"$1$3$5").replace(/^([^#]*)((\?)&|\?(#|$))/,"$1$3$4")},r.prototype.reflectNewUrl=function(e){var r,n;if((e=new t.ComponentUrl(e)).absolute!==document.location.href)return n=e.hasNoHash()?document.location.hash:"",r=e.absolute+n,r=this.removeParamFromUrl(r,"_breezy_filter"),r=this.removeParamFromUrl(r,"__"),window.history.pushState({breezy:!0,url:e.absolute+n},"",r)},r.prototype.updateCurrentBrowserState=function(){return this.currentBrowserState=window.history.state},r.prototype.changePage=function(e,r){var n;return this.currentPage&&this.assetsChanged(e)?void document.location.reload():(this.currentPage=e,this.currentPage.title=null!=(n=r.title)?n:this.currentPage.title,this.currentPage.title!==!1&&(document.title=this.currentPage.title),null!=this.currentPage.csrf_token&&t.CSRFToken.update(this.currentPage.csrf_token),this.updateCurrentBrowserState())},r.prototype.assetsChanged=function(e){var r;return this.loadedAssets||(this.loadedAssets=this.currentPage.assets),r=e.assets,r.length!==this.loadedAssets.length||t.Utils.intersection(r,this.loadedAssets).length!==this.loadedAssets.length},r.prototype.graftByKeypath=function(e,r,n){var i,s,o,a,h;for(null==n&&(n={}),a=this.pageCache,h=i=0,o=a.length;i<o;h=++i)s=a[h],this.history.pageCache[s]=t.Utils.graftByKeypath(e,r,h,n);return this.currentPage=t.Utils.graftByKeypath(e,r,this.currentPage,n),t.Utils.triggerEvent(t.EVENTS.LOAD,this.currentPage)},r}()}.call(this),function(){var e=function(t,e){return function(){return t.apply(e,arguments)}};t.ProgressBar=function(){function t(t){this.elementSelector=t,this._trickle=e(this._trickle,this),this._reset=e(this._reset,this),this.setDelay=e(this.setDelay,this),this.advanceFromEvent=e(this.advanceFromEvent,this),this.value=0,this.content="",this.speed=300,this.opacity=n,this.delay=400,this.active=null,this.install()}var r,n;return r="breezy-progress-bar",n=.99,t.prototype.install=function(){if(!this.active)return this.active=!0,this.element=document.querySelector(this.elementSelector),this.element.classList.add(r),this.styleElement=document.createElement("style"),document.head.appendChild(this.styleElement),this._updateStyle()},t.prototype.uninstall=function(){if(this.active)return this.active=!1,this.element.classList.remove(r),document.head.removeChild(this.styleElement)},t.prototype.start=function(t){var e;return e=(null!=t?t:{}).delay,clearTimeout(this.displayTimeout),this.delay?(this.display=!1,this.displayTimeout=setTimeout(function(t){return function(){return t.display=!0}}(this),this.delay)):this.display=!0,this.value>0&&(this._reset(),this._reflow()),this.advanceTo(5)},t.prototype.advanceTo=function(t){var e;if(t>(e=this.value)&&e<=100){if(this.value=t,this._updateStyle(),100===this.value)return this._stopTrickle();if(this.value>0)return this._startTrickle()}},t.prototype.advanceFromEvent=function(t){var e;return e=t.lengthComputable?t.loaded/t.total*100:this.value+(100-this.value)/10,this.advanceTo(e)},t.prototype.done=function(){if(this.value>0)return this.advanceTo(100),this._finish()},t.prototype.setDelay=function(t){return this.delay=t},t.prototype._finish=function(){return this.fadeTimer=setTimeout(function(t){return function(){return t.opacity=0,t._updateStyle()}}(this),this.speed/2),this.resetTimer=setTimeout(this._reset,this.speed)},t.prototype._reflow=function(){return this.element.offsetHeight},t.prototype._reset=function(){return this._stopTimers(),this.value=0,this.opacity=n,this._withSpeed(0,function(t){return function(){return t._updateStyle(!0)}}(this))},t.prototype._stopTimers=function(){return this._stopTrickle(),clearTimeout(this.fadeTimer),clearTimeout(this.resetTimer)},t.prototype._startTrickle=function(){if(!this.trickleTimer)return this.trickleTimer=setTimeout(this._trickle,this.speed)},t.prototype._stopTrickle=function(){return clearTimeout(this.trickleTimer),delete this.trickleTimer},t.prototype._trickle=function(){return this.advanceTo(this.value+Math.random()/2),this.trickleTimer=setTimeout(this._trickle,this.speed)},t.prototype._withSpeed=function(t,e){var r,n;return r=this.speed,this.speed=t,n=e(),this.speed=r,n},t.prototype._updateStyle=function(t){return null==t&&(t=!1),t&&this._changeContentToForceRepaint(),this.styleElement.textContent=this._createCSSRule()},t.prototype._changeContentToForceRepaint=function(){return this.content=""===this.content?" ":""},t.prototype._createCSSRule=function(){return this.elementSelector+"."+r+"::before {\n  content: '"+this.content+"';\n  position: fixed;\n  top: 0;\n  left: 0;\n  z-index: 2000;\n  background-color: #0076ff;\n  height: 3px;\n  opacity: "+this.opacity+";\n  width: "+(this.display?this.value:0)+"%;\n  transition: width "+this.speed+"ms ease-out, opacity "+this.speed/2+"ms ease-in;\n  transform: translate3d(0,0,0);\n}"},t}()}.call(this),function(){t.ParallelQueue=function(){function e(){this.dll=new t.DoublyLinkedList,this.active=!0}return e.prototype.push=function(t){return this.dll.push(t),t._originalOnLoad=t.onload.bind(t),t.onload=function(e){return function(){var r,n,i;if(e.active){for(t._isDone=!0,r=e.dll.head,i=[];r;)n=r.element,n._isDone?(r=r.next,e.dll.shift(),i.push(n._originalOnLoad())):i.push(r=null);return i}}}(this)},e.prototype.drain=function(){var e,r;for(this.active=!1,e=this.dll.head;e;)r=e.element,r.abort(),r._isDone=!0,e=e.next;return this.dll=new t.DoublyLinkedList,this.active=!0},e}()}.call(this),function(){var e,r=function(t,e){return function(){return t.apply(e,arguments)}};e=20,t.Controller=function(){function e(){this.createRequest=r(this.createRequest,this),this.onError=r(this.onError,this),this.onProgress=r(this.onProgress,this),this.onLoad=r(this.onLoad,this),this.onLoadEnd=r(this.onLoadEnd,this),this.cache=r(this.cache,this),this.pageChangePrevented=r(this.pageChangePrevented,this),this.crossOriginRedirect=r(this.crossOriginRedirect,this),this.replace=r(this.replace,this),this.restore=r(this.restore,this),this.disableRequestCaching=r(this.disableRequestCaching,this),this.enableTransitionCache=r(this.enableTransitionCache,this),this.request=r(this.request,this),this.currentPage=r(this.currentPage,this),this.atomCache={},this.history=new t.Snapshot(this),this.transitionCacheEnabled=!1,this.requestCachingEnabled=!0,this.progressBar=new t.ProgressBar("html"),this.pq=new t.ParallelQueue,this.http=null,this.history.rememberCurrentUrlAndState()}return e.prototype.currentPage=function(){return this.history.currentPage},e.prototype.request=function(e,r){var n,i,s,o;if(null==r&&(r={}),r=t.Utils.reverseMerge(r,{pushState:!0}),e=new t.ComponentUrl(e),!this.pageChangePrevented(e.absolute,r.target))return e.crossOrigin()?void(document.location.href=e.absolute):(this.history.cacheCurrentPage(),null==this.progressBar||r.async||null!=(n=this.progressBar)&&n.start(),o=this.history.transitionCacheFor(e.absolute),this.transitionCacheEnabled&&o&&o.transition_cache&&(this.history.reflectNewUrl(e),this.restore(o),r.showProgressBar=!1),null==r.cacheRequest&&(r.cacheRequest=this.requestCachingEnabled),null==r.showProgressBar&&(r.showProgressBar=!0),t.Utils.triggerEvent(t.EVENTS.FETCH,{url:e.absolute},r.target),r.async?(r.showProgressBar=!1,s=this.createRequest(e,r),s.onError=function(){return t.Utils.triggerEvent(t.EVENTS.ERROR,null,r.target)},this.pq.push(s),s.send(r.payload)):(this.pq.drain(),null!=(i=this.http)&&i.abort(),this.http=this.createRequest(e,r),this.http.send(r.payload)))},e.prototype.enableTransitionCache=function(t){return null==t&&(t=!0),this.transitionCacheEnabled=t},e.prototype.disableRequestCaching=function(t){return null==t&&(t=!0),this.requestCachingEnabled=!t,t},e.prototype.restore=function(e,r){var n,i;return null==r&&(r={}),null!=(n=this.http)&&n.abort(),this.history.changePage(e,r),null!=(i=this.progressBar)&&i.done(),t.Utils.triggerEvent(t.EVENTS.RESTORE),t.Utils.triggerEvent(t.EVENTS.LOAD,e)},e.prototype.replace=function(e,r){return null==r&&(r={}),t.Utils.withDefaults(e,this.history.currentBrowserState),this.history.changePage(e,r),t.Utils.triggerEvent(t.EVENTS.LOAD,this.currentPage())},e.prototype.crossOriginRedirect=function(){var e,r;if(r=this.http.getResponseHeader("Location"),e=new t.ComponentUrl(r).crossOrigin(),null!=r&&e)return r},e.prototype.pageChangePrevented=function(e,r){return!t.Utils.triggerEvent(t.EVENTS.BEFORE_CHANGE,{url:e},r)},e.prototype.cache=function(t,e){var r;return null===e?this.atomCache[t]:(r=this.atomCache)[t]||(r[t]=e)},e.prototype.onLoadEnd=function(){return this.http=null},e.prototype.onLoad=function(e,r,n){var i,s,o,a;if(t.Utils.triggerEvent(t.EVENTS.RECEIVE,{url:r.absolute},n.target),i=this.processResponse(e),0!==e.status)return i?n.async&&r.pathname!==this.currentPage().pathname&&!n.ignoreSamePathConstraint?(null!=(s=this.progressBar)&&s.done(),void t.Utils.warn("Async response path is different from current page path")):(n.pushState&&this.history.reflectNewUrl(r),t.Utils.withDefaults(i,this.history.currentBrowserState),"graft"!==i.action?(this.history.changePage(i,n),t.Utils.triggerEvent(t.EVENTS.LOAD,this.currentPage())):this.history.graftByKeypath("data."+i.path,i.data),n.showProgressBar&&null!=(o=this.progressBar)&&o.done(),this.history.constrainPageCacheTo()):n.async?t.Utils.triggerEvent(t.EVENTS.ERROR,e,n.target):(null!=(a=this.progressBar)&&a.done(),document.location.href=this.crossOriginRedirect()||r.absolute)},e.prototype.onProgress=function(t){return this.progressBar.advanceFromEvent(t)},e.prototype.onError=function(t){return document.location.href=t.absolute},e.prototype.createRequest=function(e,r){var n,i,s,o;return i="text/javascript, application/x-javascript, application/javascript",s=r.requestMethod||"GET",o=new XMLHttpRequest,o.open(s,e.formatForXHR({cache:r.cacheRequest}),!0),o.setRequestHeader("Accept",i),o.setRequestHeader("X-XHR-Referer",document.location.href),r.silent&&o.setRequestHeader("X-Silent",r.silent),o.setRequestHeader("X-Requested-With","XMLHttpRequest"),r.contentType&&o.setRequestHeader("Content-Type",r.contentType),n=t.CSRFToken.get().token,n&&o.setRequestHeader("X-CSRF-Token",n),r.silent?o.onload=function(t){return function(){var e;return null!=(e=t.progressBar)?e.done():void 0}}(this):o.onload=function(t){return function(){var n,i,s;return s=this,i=s.getResponseHeader("X-XHR-Redirected-To"),n=i||e,t.onLoad(s,n,r)}}(this),this.progressBar&&r.showProgressBar&&(o.onprogress=this.onProgress),o.onloadend=this.onLoadEnd,o.onerror=function(t){return function(){return t.onError(e)}}(this),o},e.prototype.processResponse=function(t){if(this.hasValidResponse(t))return this.responseContent(t)},e.prototype.hasValidResponse=function(t){return!this.clientOrServerError(t)&&this.validContent(t)&&!this.downloadingFile(t)},e.prototype.responseContent=function(t){return new Function("'use strict'; return "+t.responseText)()},e.prototype.clientOrServerError=function(t){var e;return 400<=(e=t.status)&&e<600},e.prototype.validContent=function(t){var e,r;return e=t.getResponseHeader("Content-Type"),r=/^(?:text\/javascript|application\/x-javascript|application\/javascript)(?:;|$)/,null!=e&&e.match(r)},e.prototype.downloadingFile=function(t){var e;return null!=(e=t.getResponseHeader("Content-Disposition"))&&e.match(/^attachment/)},e}()}.call(this),function(){var e=function(t,e){return function(){return t.apply(e,arguments)}},r=[].indexOf||function(t){for(var e=0,r=this.length;e<r;e++)if(e in this&&this[e]===t)return e;return-1};t.Remote=function(){function t(t,r){null==r&&(r={}),this.isValidForm=e(this.isValidForm,this),this.isValidLink=e(this.isValidLink,this),this.isValid=e(this.isValid,this),this.setPayload=e(this.setPayload,this),this.setRequestType=e(this.setRequestType,this),this.toOptions=e(this.toOptions,this),this.target=t,this.payload="",this.contentType=null,this.setRequestType(t),this.async=this.getBZAttribute(t,"bz-remote-async")||!1,this.pushState=!("false"===this.getBZAttribute(t,"bz-push-state")),this.httpUrl=t.getAttribute("href")||t.getAttribute("action"),this.silent=this.getBZAttribute(t,"bz-silent")||!1,this.setPayload(t)}var n,i,s;return s=["GET","PUT","POST","DELETE","PATCH"],i="GET",n="POST",t.prototype.toOptions=function(){return{requestMethod:this.actualRequestType,payload:this.payload,contentType:this.contentType,silent:this.silent,target:this.target,async:this.async,pushState:this.pushState}},t.prototype.setRequestType=function(t){var e,o,a;return"A"===t.tagName&&(this.httpRequestType=this.getBZAttribute(t,"bz-remote"),null==this.httpRequestType&&(this.httpRequestType=""),this.httpRequestType=this.httpRequestType.toUpperCase(),o=this.httpRequestType,r.call(s,o)<0&&(this.httpRequestType=i)),"FORM"===t.tagName&&(e=t.getAttribute("method"),this.httpRequestType=e||this.getBZAttribute(t,"bz-remote"),null==this.httpRequestType&&(this.httpRequestType=""),this.httpRequestType=this.httpRequestType.toUpperCase(),a=this.httpRequestType,r.call(s,a)<0&&(this.httpRequestType=n)),this.actualRequestType="GET"===this.httpRequestType?"GET":"POST"},t.prototype.setPayload=function(t){var e;if("FORM"===t.tagName&&(this.payload=this.nativeEncodeForm(t)),this.payload instanceof FormData){if(!t.querySelector("[name=_method]")&&"GET"!==(e=this.httpRequestType)&&"POST"!==e)return this.payload.append("_method",this.httpRequestType)}else if(this.payload.indexOf("_method")===-1&&this.httpRequestType&&"GET"!==this.actualRequestType)return this.contentType="application/x-www-form-urlencoded; charset=UTF-8",this.payload=this.formAppend(this.payload,"_method",this.httpRequestType)},t.prototype.isValid=function(){return this.isValidLink()||this.isValidForm()},t.prototype.isValidLink=function(){return"A"===this.target.tagName&&this.hasBZAttribute(this.target,"bz-remote")},t.prototype.isValidForm=function(){return"FORM"===this.target.tagName&&(this.hasBZAttribute(this.target,"bz-remote")&&null!=this.target.getAttribute("action"))},t.prototype.formAppend=function(t,e,r){return t.length&&(t+="&"),t+=encodeURIComponent(e)+"="+encodeURIComponent(r)},t.prototype.formDataAppend=function(t,e){var r,n,i,s;if("file"===e.type)for(s=e.files,n=0,i=s.length;n<i;n++)r=s[n],t.append(e.name,r);else t.append(e.name,e.value);return t},t.prototype.nativeEncodeForm=function(t){var e;return e=new FormData,this.iterateOverFormInputs(t,function(t){return function(r){return e=t.formDataAppend(e,r)}}(this)),e},t.prototype.iterateOverFormInputs=function(t,e){var r,n,i,s,o,a,h;for(s=this.enabledInputs(t),h=[],r=0,o=s.length;r<o;r++)n=s[r],i=!n.disabled,a="checkbox"===n.type||"radio"===n.type,i&&n.name&&(a&&n.checked||!a)?h.push(e(n)):h.push(void 0);return h},t.prototype.enabledInputs=function(t){var e,r,n,i,s,o,a,h,u,l,c;if(c="input:not([type='reset']):not([type='button']):not([type='submit']):not([type='image']), select, textarea",o=Array.prototype.slice.call(t.querySelectorAll(c)),r=Array.prototype.slice.call(this.querySelectorAllBZAttribute(t,"bz-remote-noserialize")),!r.length)return o;for(e=r,i=0,h=r.length;i<h;i++)l=r[i],e=e.concat(Array.prototype.slice.call(l.querySelectorAll(c)));for(n=[],a=0,u=o.length;a<u;a++)s=o[a],e.indexOf(s)<0&&n.push(s);return n},t.prototype.bzAttribute=function(t){var e;return e="bz-"===t.slice(0,3)?"data-"+t:"data-bz-"+t},t.prototype.getBZAttribute=function(t,e){var r;return r=this.bzAttribute(e),t.getAttribute(r)||t.getAttribute(e)},t.prototype.querySelectorAllBZAttribute=function(t,e,r){var n;return null==r&&(r=null),n=this.bzAttribute(e),r?t.querySelectorAll("["+n+"="+r+"], ["+e+"="+r+"]"):t.querySelectorAll("["+n+"], ["+e+"]")},t.prototype.hasBZAttribute=function(t,e){var r;return r=this.bzAttribute(e),null!=t.getAttribute(r)||null!=t.getAttribute(e)},t}()}.call(this),function(){var e,r,n,i,s,o,a,h;e={BEFORE_CHANGE:"breezy:click",ERROR:"breezy:request-error",FETCH:"breezy:request-start",RECEIVE:"breezy:request-end",LOAD:"breezy:load",RESTORE:"breezy:restore"},i=new t.Controller,o=i.progressBar,r={enable:function(){return o.install()},disable:function(){return o.uninstall()},setDelay:function(t){return o.setDelay(t)},start:function(t){return o.start(t)},advanceTo:function(t){return o.advanceTo(t)},done:function(){return o.done()}},a=function(e){var r,n;if(n=e.target,r=new t.Remote(n),r.isValid())return e.preventDefault(),i.request(r.httpUrl,r.toOptions())},n=document.addEventListener&&document.createEvent,s=function(){return r.enable(),window.addEventListener("hashchange",i.history.rememberCurrentUrlAndState,!1),window.addEventListener("popstate",i.history.onHistoryChange,!1),t.Utils.documentListenerForLinks("click",a),document.addEventListener("submit",a)},t.Utils.browserSupportsBreezy()?(h=i.request,s()):h=function(t){return null==t&&(t=document.location.href),document.location.href=t},t.controller=i,t.graftByKeypath=i.history.graftByKeypath,t.visit=h,t.replace=i.replace,t.cache=i.cache,t.pagesCached=i.history.pagesCached,t.enableTransitionCache=i.enableTransitionCache,t.disableRequestCaching=i.disableRequestCaching,t.ProgressBar=r,t.supported=t.Utils.browserSupportsBreezy(),t.EVENTS=t.Utils.clone(e),t.currentPage=i.currentPage}.call(this)}).call(this),"object"==typeof module&&module.exports?module.exports=t:"function"==typeof define&&define.amd&&define(t)}).call(this);